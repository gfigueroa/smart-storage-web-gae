<%@ page contentType="text/html; charset=utf-8" language="java" errorPage="" %>
<%@ page import="util.Printer" %>
<%@ page import="util.Dictionary" %>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
                     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link type="text/css" href="stylesheets/default-layout.css" rel="stylesheet" />
<link type="text/css" href="stylesheets/login.css" rel="stylesheet" />

<script language="JavaScript" type="text/javascript" src="js/crypto.js">
</script>

<script language="JavaScript" type="text/javascript">
function hashAndSubmit()
{
  var passwordInput = document.getElementsByName("password")[0];
  passwordInput.value = Sha256.hash(passwordInput.value);
  
  return true;
}
</script>

<title>Cloud Ordering System</title>
<meta name="viewport" content="target-densitydpi=device-dpi, width=device-width" />
</head>

<body>
<%@  include file="header/homepage-banner.html" %>
<%@  include file="menu/blank-menu.html" %>
<%
Printer printer = new Printer(Dictionary.Language.CHINESE);
session.setAttribute( "PrintLanguage", printer );
%>
<div class="welcome-banner">
  <h1><%= printer.print("Welcome!")%></h1>
</div>

<%
  String error = request.getParameter("etype");
  
  String message = request.getParameter("msg") != null ? request.getParameter("msg") : "";
  String action = request.getParameter("action") != null ? request.getParameter("action") : "";
%>

<div class="login-box">
	<div class="login-left">
	  	<form name="login-form" action="/attemptlogin" 
	    	method="POST" onSubmit="hashAndSubmit()">
			
			<div class="login-box-title">
		    <span><%= printer.print("Sign in")%></span> <br/> <%= printer.print("to access your account")%>.
		    </div>
		    
		    <%
		    if (error != null && error.equals("InvalidInfo")) {
		    %>
		        <div class="error-div">
		          Some or all of the information provided does not 
		          match any user in our database.
		        </div>
		    <%
		    }
		    %>
		    
		    <div class="login-box-user">
		    	<label>Username</label><br/>
		      	<input type="text" name="username" />
		    </div>
		    
		    <label>Password</label><br/>
		    <div class="login-box-password">
		    	<input type="password" name="password" />
		    </div>
		    
		    <div class="login-box-button">
		      	<input type="submit" value="Log In" />
		    </div>
	      
		</form>
	</div>

	<div class="login-right">
		<div class="login-box-title">
		    <span>Create</span> <br/> a new account.
		</div>
		<p>Create your account to gain access to the system.</p>
		<br/>
		<hr />
		<br/>
		<div class="login-box-button">
			<a href="/customer/autoCustomer.jsp">Create a New Account</a>
		</div>
		<%
		if (message.equals("success") && action.equals("add")) {
		%>
		<br/>
		<div class="success-div">
		User registered successfully!
		</div>
		<%
		}
		%>
	</div>
	<br style="clear:both;"/>  
</div>

<hr style="width:98%;text-align:center;"/>

<%@  include file="../header/page-footer.html" %>

</body>
</html>
